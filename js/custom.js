var percentFlag=!1;function essayScroll(){const e=(document.documentElement.scrollTop||window.pageYOffset)%document.documentElement.clientHeight;result<=99||(result=99),!percentFlag&&e+100>=document.documentElement.clientHeight&&document.querySelector("#waterfall")?setTimeout((()=>{waterfall("#waterfall")}),500):setTimeout((()=>{document.querySelector("#waterfall")&&waterfall("#waterfall")}),500);const t=window.scrollY+document.documentElement.clientHeight;let n=document.getElementById("post-comment")||document.getElementById("footer");(n.offsetTop+n.offsetHeight/2<t||90<result)&&(percentFlag=!0)}function replaceAll(e,t,n){return e.split(t).join(n)}var ivany={switchCommentBarrage:function(){document.querySelector(".comment-barrage")&&($(".comment-barrage").is(":visible")?($(".comment-barrage").hide(),$(".menu-commentBarrage-text").text("显示热评"),document.querySelector("#consoleCommentBarrage").classList.remove("on"),localStorage.setItem("commentBarrageSwitch","false")):$(".comment-barrage").is(":hidden")&&($(".comment-barrage").show(),$(".menu-commentBarrage-text").text("关闭热评"),document.querySelector("#consoleCommentBarrage").classList.add("on"),localStorage.removeItem("commentBarrageSwitch")))},hideAsideBtn:()=>{const e=document.documentElement.classList;e.contains("hide-aside")?saveToLocal.set("aside-status","show",2):saveToLocal.set("aside-status","hide",2),e.toggle("hide-aside"),e.contains("hide-aside")?document.querySelector("#consoleHideAside").classList.add("on"):document.querySelector("#consoleHideAside").classList.remove("on")},initConsoleState:function(){document.documentElement.classList.contains("hide-aside")?document.querySelector("#consoleHideAside").classList.add("on"):document.querySelector("#consoleHideAside").classList.remove("on")},showConsole:function(){document.querySelector("#console").classList.add("show"),ivany.initConsoleState()},hideConsole:function(){document.querySelector("#console").classList.remove("show")},is_Post:function(){return window.location.href.indexOf("/posts/")>=0},changeThemeColor:function(e){null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content",e)},initThemeColor:function(){const e=window.scrollY||document.documentElement.scrollTop;if(ivany.is_Post()){if(e>0){let e=getComputedStyle(document.documentElement).getPropertyValue("--ivany-card-bg");ivany.changeThemeColor(e)}else if(0===e){let e=getComputedStyle(document.documentElement).getPropertyValue("--ivany-theme");ivany.changeThemeColor(e)}}else if(e>0){let e=getComputedStyle(document.documentElement).getPropertyValue("--ivany-card-bg");ivany.changeThemeColor(e)}else if(0===e){let e=getComputedStyle(document.documentElement).getPropertyValue("--ivany-background");ivany.changeThemeColor(e)}},diffDate:function(e,t=!1){const n=new Date,o=new Date(e),a=n.getTime()-o.getTime(),c=36e5,i=24*c;let s;if(t){const e=a/i,t=a/c,n=a/6e4;s=a/2592e6>=1?o.toLocaleDateString().replace(/\//g,"-"):e>=1?parseInt(e)+" "+GLOBAL_CONFIG.date_suffix.day:t>=1?parseInt(t)+" "+GLOBAL_CONFIG.date_suffix.hour:n>=1?parseInt(n)+" "+GLOBAL_CONFIG.date_suffix.min:GLOBAL_CONFIG.date_suffix.just}else s=parseInt(a/i);return s},changeTimeInEssay:function(){document.querySelector("#bber")&&document.querySelectorAll("#bber time").forEach((function(e){var t=e,n=t.getAttribute("datetime");t.innerText=ivany.diffDate(n,!0),t.style.display="inline"}))},reflashEssayWaterFall:function(){document.querySelector("#waterfall")&&setTimeout((function(){waterfall("#waterfall"),document.getElementById("waterfall").classList.add("show")}),500)},commentText:function(e){"undefined"!=e&&"null"!=e||(e="好棒！");var t=document.getElementsByClassName("el-textarea__inner")[0],n=document.createEvent("HTMLEvents");if(t){n.initEvent("input",!0,!0);var o=replaceAll(e,"\n","\n> ");t.value="> "+o+"\n\n",t.dispatchEvent(n);var a=document.querySelector("#post-comment").offsetTop;window.scrollTo(0,a-80),t.focus(),t.setSelectionRange(-1,-1),document.getElementById("comment-tips")&&document.getElementById("comment-tips").classList.add("show")}},initIndexEssay:function(){setTimeout((()=>{let e=new Swiper(".essay_bar_swiper_container",{passiveListeners:!0,direction:"vertical",loop:!0,autoplay:{disableOnInteraction:!0,delay:3e3},mousewheel:!0}),t=document.getElementById("bbtalk");null!==t&&(t.onmouseenter=function(){e.autoplay.stop()},t.onmouseleave=function(){e.autoplay.start()})}),100)},musicToggle:function(e=!0){ivany_musicFirst||(musicBindEvent(),ivany_musicFirst=!0);ivany_musicPlaying?(document.querySelector("#nav-music").classList.remove("playing"),document.getElementById("nav-music-hoverTips").innerHTML="音乐已暂停",document.querySelector("#consoleMusic").classList.remove("on"),ivany_musicPlaying=!1,document.querySelector("#nav-music").classList.remove("stretch"),ivany_musicStretch=!1):(document.querySelector("#nav-music").classList.add("playing"),document.querySelector("#consoleMusic").classList.add("on"),ivany_musicPlaying=!0,document.querySelector("#nav-music").classList.add("stretch"),ivany_musicStretch=!0),e&&document.querySelector("#nav-music meting-js").aplayer.toggle()},musicTelescopic:function(){ivany_musicStretch?(document.querySelector("#nav-music").classList.remove("stretch"),ivany_musicStretch=!1):(document.querySelector("#nav-music").classList.add("stretch"),ivany_musicStretch=!0)},musicSkipBack:function(){document.querySelector("#nav-music meting-js").aplayer.skipBack()},musicSkipForward:function(){document.querySelector("#nav-music meting-js").aplayer.skipForward()},musicGetName:function(){for(var e=$(".aplayer-title"),t=[],n=e.length-1;n>=0;n--)t[n]=e[n].innerText;return t[0]},changeMusicBg:function(e=!0){if("/music/"!=window.location.pathname)return;const t=document.getElementById("an_music_bg");if(e){const e=document.querySelector("#anMusic-page .aplayer-pic");t.style.backgroundImage=e.style.backgroundImage}else{let e=setInterval((()=>{const n=document.querySelector("#anMusic-page .aplayer-pic");n&&(clearInterval(e),t.style.backgroundImage=n.style.backgroundImage,ivany.addEventListenerChangeMusicBg(),document.querySelector("#nav-music meting-js").aplayer&&!document.querySelector("#nav-music meting-js").aplayer.audio.paused&&ivany.musicToggle())}),100)}},addEventListenerChangeMusicBg:function(){const e=document.getElementById("anMusic-page"),t=e.querySelector(".aplayer-info .aplayer-time .aplayer-icon-menu");e.querySelector("meting-js").aplayer.on("loadeddata",(function(){ivany.changeMusicBg(),console.info("player loadeddata")})),t.addEventListener("click",(function(){document.getElementById("menu-mask").style.display="block",document.getElementById("menu-mask").style.animation="0.5s ease 0s 1 normal none running to_show"})),document.getElementById("menu-mask").addEventListener("click",(function(){"/music/"==window.location.pathname&&e.querySelector(".aplayer-list").classList.remove("aplayer-list-hide")}))}};function browserTC(){btf.snackbarShow(""),Snackbar.show({text:"浏览器版本较低，网站样式可能错乱",actionText:"关闭",duration:"6000",pos:"bottom-right"})}function browserVersion(){var e=navigator.userAgent,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1,n=(e.indexOf("Trident")>-1&&e.indexOf("rv:11.0"),e.indexOf("Edge")>-1&&!t),o=e.indexOf("Firefox")>-1,a=e.indexOf("Opera")>-1||e.indexOf("OPR")>-1,c=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1&&-1==e.indexOf("Edge")&&-1==e.indexOf("OPR");e.indexOf("Safari")>-1&&-1==e.indexOf("Chrome")&&-1==e.indexOf("Edge")&&e.indexOf("OPR");n?e.split("Edge/")[1].split(".")[0]<90&&browserTC():o?e.split("Firefox/")[1].split(".")[0]<90&&browserTC():a?e.split("OPR/")[1].split(".")[0]<80&&browserTC():c&&e.split("Chrome/")[1].split(".")[0]<90&&browserTC()}function setCookies(e,t){let n=new Date((new Date).getTime()+24*t*60*60*1e3).toGMTString();for(let t in e)document.cookie=t+"="+e[t]+";expires="+n}function getCookie(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?unescape(t[2]):null}function musicBindEvent(){document.querySelector("#nav-music .aplayer-music").addEventListener("click",(function(){ivany.musicTelescopic()}))}ivany.is_Post(),ivany.initIndexEssay(),ivany.changeTimeInEssay(),ivany.reflashEssayWaterFall(),window.onkeydown=function(e){123===e.keyCode&&btf.snackbarShow("开发者模式已打开，请遵循GPL协议",!1,3e3)},document.addEventListener("scroll",btf.throttle((function(){ivany.initThemeColor()}),200)),1!=getCookie("browsertc")&&(setCookies({browsertc:1},1),browserVersion());var ivany_musicPlaying=!1,ivany_musicStretch=!1,ivany_musicFirst=!1;function clear(){clearInternal(timer),document.querySelector(".comment-barrage").innerHtml="",load()}function load(){timer=setInteral((()=>{popCommentBarrage()}),114514)}document.getElementsByClassName("back-home-button")[0].hover=function(){document.getElementsByClassName("back-menu-list-groups")[0].setAttribute("style","opacity:1 !important; display:block !important; pointer-events: all !important")};var $percent=document.querySelector("#nav #hotkey #top-button a.site-page i");function todis(){function e(){let e="light"===document.documentElement.getAttribute("data-theme")?"#4C4948":"rgba(255,255,255,0.7)";if(document.getElementById("posts-chart")&&postsOption)try{let t=postsOption;t.title.textStyle.color=e,t.xAxis.nameTextStyle.color=e,t.yAxis.nameTextStyle.color=e,t.xAxis.axisLabel.color=e,t.yAxis.axisLabel.color=e,t.xAxis.axisLine.lineStyle.color=e,t.yAxis.axisLine.lineStyle.color=e,t.series[0].markLine.data[0].label.color=e,postsChart.setOption(t)}catch(e){console.log(e)}if(document.getElementById("tags-chart")&&tagsOption)try{let t=tagsOption;t.title.textStyle.color=e,t.xAxis.nameTextStyle.color=e,t.yAxis.nameTextStyle.color=e,t.xAxis.axisLabel.color=e,t.yAxis.axisLabel.color=e,t.xAxis.axisLine.lineStyle.color=e,t.yAxis.axisLine.lineStyle.color=e,t.series[0].markLine.data[0].label.color=e,tagsChart.setOption(t)}catch(e){console.log(e)}if(document.getElementById("categories-chart")&&categoriesOption)try{let t=categoriesOption;t.title.textStyle.color=e,t.legend.textStyle.color=e,categoryParentFlag||(t.series[0].label.color=e),categoriesChart.setOption(t)}catch(e){console.log(e)}}$.ajax({type:"get",url:"https://apis.map.qq.com/ws/location/v1/ip",data:{key:"T3EBZ-TJ7LI-YRBG2-5ZLUR-KD3OS-U6BJO",output:"jsonp"},dataType:"jsonp",success:function(e){ipLoacation=e,function(){let e,t,n=function(e,t,n,o){const{sin:a,cos:c,asin:i,PI:s,hypot:r}=Math;let l=(e,t)=>(e*=s/180,{x:c(t*=s/180)*c(e),y:c(t)*a(e),z:a(t)}),u=l(e,t),m=l(n,o),d=2*i(r(u.x-m.x,u.y-m.y,u.z-m.z)/2)*6371;return Math.round(d)}(106.3612,29.5951,ipLoacation.result.location.lng,ipLoacation.result.location.lat),o=ipLoacation.result.ad_info.nation;switch(ipLoacation.result.ad_info.nation){case"日本":e="よろしく，一起去看樱花吗";break;case"美国":e="Make America Great Again!";break;case"英国":e="想同你一起夜乘伦敦眼";break;case"俄罗斯":e="干了这瓶伏特加！";break;case"法国":e="C'est La Vie";break;case"德国":e="Die Zeit verging im Fluge.";break;case"澳大利亚":e="一起去大堡礁吧！";break;case"加拿大":e="拾起一片枫叶赠予你";break;case"中国":switch(o=ipLoacation.result.ad_info.province+" "+ipLoacation.result.ad_info.city,ipLoacation.result.ad_info.province){case"北京市":e="北——京——欢迎你~~~";break;case"天津市":e="讲段相声吧。";break;case"重庆市":e="老乡, 过来吃火锅呀！！！";break;case"河北省":e="山势巍巍成壁垒，天下雄关。铁马金戈由此向，无限江山。";break;case"山西省":e="展开坐具长三尺，已占山河五百余。";break;case"内蒙古自治区":e="天苍苍，野茫茫，风吹草低见牛羊。";break;case"辽宁省":e="我想吃烤鸡架！";break;case"吉林省":e="状元阁就是东北烧烤之王。";break;case"黑龙江省":e="很喜欢哈尔滨大剧院。";break;case"上海市":e="众所周知，中国只有两个城市。";break;case"江苏省":switch(ipLoacation.result.ad_info.city){case"南京市":e="欢迎来自安徽省南京市的小伙伴。";break;case"苏州市":e="上有天堂，下有苏杭。";break;default:e="散装是必须要散装的。"}break;case"浙江省":e="东风渐绿西湖柳，雁已还人未南归。";break;case"安徽省":e="蚌埠住了，芜湖起飞。";break;case"福建省":e="井邑白云间，岩城远带山。";break;case"江西省":e="落霞与孤鹜齐飞，秋水共长天一色。";break;case"山东省":e="遥望齐州九点烟，一泓海水杯中泻。";break;case"湖北省":e="来碗热干面！";break;case"湖南省":e="74751，长沙斯塔克。";break;case"广东省":e="老板来两斤福建人。";break;case"广西壮族自治区":e="桂林山水甲天下。";break;case"海南省":e="朝观日出逐白浪，夕看云起收霞光。";break;case"四川省":e="康康川妹子。";break;case"贵州省":e="茅台，学生，再塞200。";break;case"云南省":e="玉龙飞舞云缠绕，万仞冰川直耸天。";break;case"西藏自治区":e="躺在茫茫草原上，仰望蓝天。";break;case"陕西省":e="来份臊子面加馍。";break;case"甘肃省":e="羌笛何须怨杨柳，春风不度玉门关。";break;case"青海省":e="牛肉干和老酸奶都好好吃。";break;case"宁夏回族自治区":e="大漠孤烟直，长河落日圆。";break;case"新疆维吾尔自治区":e="驼铃古道丝绸路，胡马犹闻唐汉风。";break;case"台湾省":e="我在这头，大陆在那头。";break;case"香港特别行政区":e="永定贼有残留地鬼嚎，迎击光非岁玉。";break;case"澳门特别行政区":e="性感荷官，在线发牌。";break;default:e="社会主义大法好。"}break;default:e="带我去你的国家逛逛吧。"}let a=new Date;t=a.getHours()>=5&&a.getHours()<11?"<span>上午好</span>，一日之计在于晨":a.getHours()>=11&&a.getHours()<13?"<span>中午好</span>，该摸鱼吃午饭了":a.getHours()>=13&&a.getHours()<15?"<span>下午好</span>，懒懒地睡个午觉吧！":a.getHours()>=15&&a.getHours()<16?"<span>三点几啦</span>，饮茶先啦！":a.getHours()>=16&&a.getHours()<19?"<span>夕阳无限好！</span>":a.getHours()>=19&&a.getHours()<24?"<span>晚上好</span>，夜生活嗨起来！":"夜深了，早点休息，少熬夜",document.getElementsByClassName("announcement_content")[0].innerHTML=`欢迎来自<span>${o}</span>的小伙伴，${t}<br>\n        你距离Ivany约有<span>${n}</span>公里，${e}\n        <br>\n        <br>\n        本网站的Twikoo评论系统使用<a href="https://cravatar.cn">Cravatar</a>头像系统，请自行绑定邮箱配置\n        `}()}}),document.querySelector(".rightMenu-item:has(.fa-moon)").addEventListener("click",(function(){setTimeout(e,100)})),document.getElementById("con-mode").addEventListener("click",(function(){setTimeout(e,100)}))}function whenDOMReady(){"/photos/"==location.pathname&&photos()}function photos(){fetch("https://memos.mirl.ml/api/memo?openId=c7daa8fe-9633-40e6-b7e9-951d3b8e59bb").then((e=>e.json())).then((e=>{let t="",n=[];e.data.forEach((e=>{n=n.concat(e.content.match(/\!\[.*?\]\(.*?\)/g))})),n.forEach((e=>{let n,o,a=e.replace(/!\[.*?\]\((.*?)\)/g,"$1"),c=e.replace(/!\[(.*?)\]\(.*?\)/g,"$1");-1!=c.indexOf(" ")?(n=c.split(" ")[0],o=c.split(" ")[1]):o=c,t+=`<div class="gallery-photo"><a href="${a}" data-fancybox="gallery" class="fancybox" data-thumb="${a}"><img class="photo-img" loading='lazy' decoding="async" src="${a}"></a>`,o&&(t+=`<span class="photo-title">${o}</span>`),n&&(t+=`<span class="photo-time">${n}</span>`),t+="</div>"})),document.querySelector(".gallery-photos.page").innerHTML=t,imgStatus.watch(".photo-img",(()=>{waterfall(".gallery-photos")})),window.Lately&&Lately.init({target:".photo-time"})})).catch()}function categoriesBarActive(){var e=window.location.pathname;if("/"==(e=decodeURIComponent(e)))document.querySelector("#category-bar")&&document.getElementById("首页").classList.add("select");else{if(/\/categories\/.*?\//.test(e)){var t=e.split("/")[2];document.querySelector("#category-bar")&&document.getElementById(t).classList.add("select")}}}function topCategoriesBarScroll(){if(document.getElementById("category-bar-items")){let e=document.getElementById("category-bar-items");e.addEventListener("mousewheel",(function(t){let n=-t.wheelDelta/2;e.scrollLeft+=n,t.preventDefault()}),!1)}}function bannertime(){var e,t=document.getElementById("topGroup"),n=document.getElementById("todayCard"),o=!1;t.addEventListener("mouseover",(function(){clearTimeout(e),e=setTimeout((function(){o=!0,n.style.opacity=0,setTimeout((()=>{n.style.zIndex=-1}),300)}),500)})),t.addEventListener("mouseout",(function(){clearTimeout(e),o&&(e=setTimeout((function(){n.style.opacity=1,n.style.zIndex=2}),500))}))}$percent&&window.addEventListener("scroll",(function(){let e=document.body.scrollHeight||document.documentElement.scrollHeight,t=window.innerHeight||document.documentElement.clientHeight;$percent.dataset.percent=((document.body.scrollTop||document.documentElement.scrollTop)/(e-t)*100).toFixed(0)})),document.addEventListener("pjax:complete",todis),document.addEventListener("DOMContentLoaded",todis),whenDOMReady(),document.addEventListener("pjax:complete",whenDOMReady),window.onresize=()=>{"/photos/"==location.pathname&&waterfall(".gallery-photos")},ivany.changeMusicBg(!1),categoriesBarActive(),topCategoriesBarScroll(),bannertime();var mySwiper=new Swiper(".banner-swiper",{direction:"horizontal",loop:!0,autoplay:{delay:1e4,stopOnLastSlide:!1,disableOnInteraction:!1,pauseOnMouseEnter:!1},mousewheel:!0,grabCursor:!0,pagination:{el:".swiper-pagination",clickable:!0}});